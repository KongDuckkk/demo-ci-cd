name: HTML CI

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  html-syntax-check:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: HTML syntax robot
        run: |
          FILE="index.html"

          echo "üîç Checking $FILE"

          # 1. File must exist
          if [ ! -f "$FILE" ]; then
            echo "‚ùå index.html not found"
            exit 1
          fi

          # 2. DOCTYPE
          if ! grep -iq "<!DOCTYPE html>" "$FILE"; then
            echo "‚ùå Missing <!DOCTYPE html>"
            exit 1
          fi

          # 3. html tag
          if ! grep -iq "<html" "$FILE" || ! grep -iq "</html>" "$FILE"; then
            echo "‚ùå <html> tag not properly closed"
            exit 1
          fi

          # 4. body tag
          if ! grep -iq "<body" "$FILE" || ! grep -iq "</body>" "$FILE"; then
            echo "‚ùå <body> tag not properly closed"
            exit 1
          fi

          # 5. Invalid comment
          if grep -q "^-->" "$FILE"; then
            echo "‚ùå Invalid HTML comment detected"
            exit 1
          fi

          # 6. Invalid token
          if grep -q "<?>" "$FILE"; then
            echo "‚ùå Invalid token <?>"
            exit 1
          fi

          # 7. Basic tag pairing check
          for tag in h1 p title head; do
            OPEN=$(grep -io "<$tag[^>]*>" "$FILE" | wc -l)
            CLOSE=$(grep -io "</$tag>" "$FILE" | wc -l)
            if [ "$OPEN" -ne "$CLOSE" ]; then
              echo "‚ùå <$tag> tag not properly closed"
              exit 1
            fi
          done

          echo "‚úÖ HTML syntax check PASSED"
